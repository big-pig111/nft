<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Solana Token Transactions Viewer</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    input, button { margin: 10px 0; padding: 8px; width: 100%; }
    #result { margin-top: 20px; white-space: pre-wrap; background: #f5f5f5; padding: 10px; border-radius: 8px; }
  </style>
</head>
<body>
  <h2>ğŸ” æŸ¥è¯¢ Solana ä¸ŠæŒ‡å®šä»£å¸çš„äº¤æ˜“è®°å½•</h2>

  <label for="tokenAddress">è¾“å…¥ä»£å¸ Mint åœ°å€ï¼š</label>
  <input type="text" id="tokenAddress" placeholder="å¦‚ï¼šSo11111111111111111111111111111111111111112" />

  <button onclick="queryTransactions()">æŸ¥è¯¢æœ€è¿‘ 20 æ¡äº¤æ˜“è®°å½•</button>

  <div id="result">ç»“æœå°†åœ¨è¿™é‡Œæ˜¾ç¤º</div>

  <script>
    async function queryTransactions() {
      const tokenAddress = document.getElementById("tokenAddress").value.trim();
      const resultDiv = document.getElementById("result");

      if (!tokenAddress) {
        resultDiv.textContent = "è¯·è¾“å…¥ä¸€ä¸ªä»£å¸ mint åœ°å€ã€‚";
        return;
      }

      const heliusUrl = "https://api.helius.xyz/v0/transactions/search?api-key=17d82c3f-fbe0-451c-a882-70de20ad4162";

      const body = {
        jsonrpc: "2.0",
        id: "getTokenTransactions",
        method: "searchTransactions",
        params: {
          "query": {
            "rawTokenTransfers": {
              "mint": tokenAddress
            }
          },
          "options": {
            "limit": 20,
            "sort": "desc"
          }
        }
      };

      try {
        const res = await fetch(heliusUrl, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(body)
        });

        if (!res.ok) {
          throw new Error(`è¯·æ±‚å¤±è´¥: ${res.status}`);
        }

        const data = await res.json();

        if (!data.result || data.result.length === 0) {
          resultDiv.textContent = "æ²¡æœ‰æ‰¾åˆ°ç›¸å…³äº¤æ˜“è®°å½•ã€‚";
          return;
        }

        let output = "";
        data.result.forEach((tx, index) => {
          const time = new Date(tx.timestamp * 1000).toLocaleString();
          const sig = tx.signature;
          const amount = tx.rawTokenTransfers?.[0]?.tokenAmount || "æœªçŸ¥";
          const from = tx.rawTokenTransfers?.[0]?.fromUserAccount || "æœªçŸ¥";
          const to = tx.rawTokenTransfers?.[0]?.toUserAccount || "æœªçŸ¥";

          output += `ğŸŸ¢ ç¬¬ ${index + 1} æ¡äº¤æ˜“\næ—¶é—´: ${time}\nç­¾å: ${sig}\næ•°é‡: ${amount}\nFrom: ${from}\nTo: ${to}\n\n`;
        });

        resultDiv.textContent = output;
      } catch (err) {
        resultDiv.textContent = `æŸ¥è¯¢å¤±è´¥: ${err.message}`;
        console.error(err);
      }
    }
  </script>
</body>
</html>
