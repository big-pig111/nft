<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Solana Token Tracker</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f2f2f2;
      padding: 2rem;
    }
    .container {
      max-width: 800px;
      margin: auto;
      background: white;
      padding: 2rem;
      border-radius: 12px;
      box-shadow: 0 0 12px rgba(0,0,0,0.1);
    }
    input {
      width: 100%;
      padding: 10px;
      margin-bottom: 1rem;
      border: 1px solid #ccc;
      border-radius: 8px;
    }
    button {
      padding: 10px 20px;
      background: #1e90ff;
      border: none;
      border-radius: 8px;
      color: white;
      cursor: pointer;
    }
    button:hover {
      background: #0074e4;
    }
    .tx {
      padding: 1rem;
      margin: 1rem 0;
      background: #f9f9f9;
      border-radius: 8px;
      border: 1px solid #ddd;
    }
    .tx a {
      color: #1e90ff;
      text-decoration: none;
    }
    .tx a:hover {
      text-decoration: underline;
    }
    .loading {
      color: #888;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>ğŸ” æŸ¥è¯¢ Solana Token Mint äº¤æ˜“è®°å½•</h2>
    <input id="mintInput" placeholder="è¾“å…¥ token mint åœ°å€">
    <button onclick="queryTransactions()">æŸ¥è¯¢</button>
    <div id="result" class="loading"></div>
  </div>

  <script>
    const RPC_URL = "https://mainnet.helius-rpc.com/?api-key=17d82c3f-fbe0-451c-a882-70de20ad4162";

    async function queryTransactions() {
      const mint = document.getElementById("mintInput").value.trim();
      const resultDiv = document.getElementById("result");
      resultDiv.innerHTML = "<p class='loading'>æ­£åœ¨æŸ¥è¯¢ï¼Œè¯·ç¨å€™...</p>";

      if (!mint || mint.length < 32) {
        resultDiv.innerHTML = "<p style='color:red'>è¯·è¾“å…¥æœ‰æ•ˆçš„ token mint åœ°å€ã€‚</p>";
        return;
      }

      try {
        const sigsRes = await fetch(RPC_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            jsonrpc: "2.0",
            id: 1,
            method: "getSignaturesForAddress",
            params: [mint, { limit: 20 }]
          })
        });

        const sigsJson = await sigsRes.json();
        const signatures = sigsJson.result;

        if (!signatures || signatures.length === 0) {
          resultDiv.innerHTML = "<p>æ²¡æœ‰æŸ¥è¯¢åˆ°äº¤æ˜“è®°å½•ã€‚</p>";
          return;
        }

        let output = "";

        for (const sig of signatures) {
          const txRes = await fetch(RPC_URL, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
              jsonrpc: "2.0",
              id: 1,
              method: "getParsedTransaction",
              params: [sig.signature, { maxSupportedTransactionVersion: 0 }]
            })
          });

          const txJson = await txRes.json();
          const tx = txJson.result;

          if (!tx) continue;

          const time = new Date(tx.blockTime * 1000).toLocaleString();
          const txid = sig.signature;
          const txlink = `https://solscan.io/tx/${txid}`;
          let from = "-", to = "-", amount = "-";

          const instructions = tx.transaction.message.instructions;
          for (const ix of instructions) {
            if (ix.parsed?.type === "transfer" && ix.program === "spl-token") {
              from = ix.parsed.info.source;
              to = ix.parsed.info.destination;
              amount = ix.parsed.info.amount;
              break;
            }
          }

          output += `
            <div class="tx">
              <p><strong>ğŸ§¾ TxID:</strong> <a href="${txlink}" target="_blank">${txid.slice(0, 12)}...</a></p>
              <p><strong>ğŸ“¤ From:</strong> ${from}</p>
              <p><strong>ğŸ“¥ To:</strong> ${to}</p>
              <p><strong>ğŸ’° Amount:</strong> ${amount}</p>
              <p><strong>ğŸ•’ Time:</strong> ${time}</p>
            </div>
          `;
        }

        resultDiv.innerHTML = output;
      } catch (err) {
        console.error(err);
        resultDiv.innerHTML = "<p style='color:red'>æŸ¥è¯¢å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œæˆ– RPCã€‚</p>";
      }
    }
  </script>
</body>
</html>
